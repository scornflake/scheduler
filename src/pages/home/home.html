<ion-header>
    <ion-toolbar>
        <ion-title>Dashboard</ion-title>
        <button start ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <!--<button ion-button-->
        <!--(click)="clear_selection()"-->
        <!--[disabled]="!rootStore.ui_store.have_selection">Deselect-->
        <!--</button>-->
        <!--<button ion-button *ngIf="!rootStore.ui_store.signed_in_to_google"-->
        <!--(click)="login()">Login-->
        <!--</button>-->
        <!--<button ion-button *ngIf="rootStore.ui_store.signed_in_to_google"-->
        <!--(click)="logout()">Logout-->
        <!--</button>-->
        <!--</ion-buttons>-->
    </ion-toolbar>
    <saving-state></saving-state>
</ion-header>

<ion-content >
    <ion-item id="planselection" no-padding>
        <ion-label class="hidden-sm-down">Showing Plan</ion-label>
        <ion-select *ngIf="(store.saved_state$ | async) as state"
                    col-sm col-md-8 text-center
                    [ngModel]="state.selected_plan_uuid" (ngModelChange)="state.selected_plan_uuid = $event"
                    placeholder="Plan">
            <ion-option *ngFor="let p of plansByDateLatestFirst" value="{{p.uuid}}"
                        [selected]="state.selected_plan_uuid == p.uuid">
                {{p.name}} {{p.start_date|date:'shortDate'}}-{{p.end_date|date:'shortDate'}}
            </ion-option>
        </ion-select>
    </ion-item>
    <ion-grid>
        <ion-row>
            <ion-col auto *ngIf="(store.schedule$|async) as schedule">
                <schedule-viewer [schedule]="schedule"></schedule-viewer>
            </ion-col>
        </ion-row>
        <ion-row>
            <ion-col *ngIf="store.ui_store.have_selection">
                <person-editor></person-editor>
                <reasons *ngIf="store.schedule$|async as schedule"
                         [decisions]="schedule.reasons_for(store.ui_store.selected_person, store.ui_store.selected_date)"
                >
                </reasons>
            </ion-col>
        </ion-row>
    </ion-grid>
</ion-content>

<ion-footer>
    <ion-buttons *ngIf="(store.saved_state$ | async) as state">
        <button small ion-button
                (click)="export_as_csv()">To CSV
        </button>
        <button small ion-button *ngIf="state.have_previous_selection"
                (click)="read_as_previous_schedule()">Read Previous...
        </button>
        <button small ion-button *ngIf="!state.have_previous_selection"
                (click)="select_previous_schedule()">Select Previous...
        </button>
        <button small ion-button *ngIf="store.ui_store.signed_in_to_google"
                (click)="export_as_sheets()">Export Sheet...
        </button>
        <button small ion-button *ngIf="store.ui_store.signed_in_to_google"
                (click)="clear_sheet_state()">Clear State
        </button>
    </ion-buttons>
</ion-footer>