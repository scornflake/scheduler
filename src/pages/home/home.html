<ion-header>
    <ion-toolbar>
        <ion-title>Dashboard</ion-title>
        <button start ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <!--<button ion-button-->
        <!--(click)="clear_selection()"-->
        <!--[disabled]="!rootStore.ui_store.have_selection">Deselect-->
        <!--</button>-->
        <!--<button ion-button *ngIf="!rootStore.ui_store.signed_in_to_google"-->
        <!--(click)="login()">Login-->
        <!--</button>-->
        <!--<button ion-button *ngIf="rootStore.ui_store.signed_in_to_google"-->
        <!--(click)="logout()">Logout-->
        <!--</button>-->
        <!--</ion-buttons>-->
    </ion-toolbar>
    <saving-state></saving-state>
</ion-header>

<ion-content>
    <div *ngIf="store.ui_store$|async as ui">
        <div *ngIf="ui.signed_in; else notSignedIn">
            <ion-item id="planselection" no-padding *ngIf="store.saved_state$ | async as ss">
                <ion-label class="hidden-sm-down" padding-left>Showing Plan</ion-label>
                <ion-select
                        col-sm col-md-8 text-center
                        [ngModel]="ss.selected_plan_uuid" (ngModelChange)="ss.selected_plan_uuid = $event"
                        placeholder="Plan">
                    <ion-option *ngFor="let p of plansByDateLatestFirst" value="{{p.uuid}}"
                                [selected]="ss.selected_plan_uuid == p.uuid">
                        {{p.name}} {{p.start_date|date:'shortDate'}}-{{p.end_date|date:'shortDate'}}
                    </ion-option>
                </ion-select>
            </ion-item>
            <ion-grid *ngIf="store.schedule$ | async as schedule">
                <ion-row>
                    <ion-col auto>
                        <schedule-viewer [schedule]="schedule"></schedule-viewer>
                    </ion-col>
                </ion-row>
                <ion-row>
                    <ion-col *ngIf="store.ui_store.have_selection">
                        <person-editor></person-editor>
                        <reasons *ngIf="store.schedule$|async as schedule"
                                 [decisions]="schedule.reasons_for(store.ui_store.selected_person, store.ui_store.selected_date)"
                        >
                        </reasons>
                    </ion-col>
                </ion-row>
                <person-schedule [person]="store.loggedInPerson" [schedule]="schedule"></person-schedule>
            </ion-grid>
        </div>
        <ng-template #notSignedIn>
            Please sign in
        </ng-template>
    </div>
</ion-content>

<ion-footer>
    <ion-buttons>
        <button small ion-button (tap)="change_state()">Test</button>
    </ion-buttons>
    <!--<ion-buttons *ngIf="(store.saved_state$ | async) as state">-->
    <!--<button small ion-button-->
    <!--(click)="export_as_csv()">To CSV-->
    <!--</button>-->
    <!--<button small ion-button *ngIf="state.have_previous_selection"-->
    <!--(click)="read_as_previous_schedule()">Read Previous...-->
    <!--</button>-->
    <!--<button small ion-button *ngIf="!state.have_previous_selection"-->
    <!--(click)="select_previous_schedule()">Select Previous...-->
    <!--</button>-->
    <!--<button small ion-button *ngIf="store.ui_store.signed_in_to_google"-->
    <!--(click)="export_as_sheets()">Export Sheet...-->
    <!--</button>-->
    <!--<button small ion-button *ngIf="store.ui_store.signed_in_to_google"-->
    <!--(click)="clear_sheet_state()">Clear State-->
    <!--</button>-->
    <!--</ion-buttons>-->
</ion-footer>