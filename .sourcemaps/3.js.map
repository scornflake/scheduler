{"version":3,"sources":["../../src/pages/person-assignment/person-assignment.module.ts","../../src/pages/person-assignment/person-assignment.ts"],"names":[],"mappings":"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","file":"3.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PersonAssignmentPage } from './person-assignment';\n\n@NgModule({\n  declarations: [\n    PersonAssignmentPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(PersonAssignmentPage),\n  ],\n})\nexport class PersonAssignmentPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/person-assignment/person-assignment.module.ts","import {Component} from '@angular/core';\nimport {AlertController, IonicPage, NavController, NavParams, PopoverController, ViewController} from 'ionic-angular';\nimport {Assignment} from \"../../scheduling/assignment\";\nimport {ScheduleOn, TryToScheduleWith} from \"../../scheduling/rule_based/rules\";\nimport {Availability, AvailabilityUnit} from \"../../scheduling/availability\";\nimport {Person} from \"../../scheduling/people\";\nimport {RootStore} from \"../../store/root\";\nimport {Role} from \"../../scheduling/role\";\n\n@IonicPage()\n@Component({\n    selector: 'page-person-assignment',\n    templateUrl: 'person-assignment.html',\n})\nexport class PersonAssignmentPage {\n    assignment: Assignment;\n    private active: ViewController;\n\n    constructor(public navCtrl: NavController,\n                public rootStore: RootStore,\n                public alertCtrl: AlertController,\n                public popoverCtrl: PopoverController,\n                public navParams: NavParams) {\n        this.assignment = navParams.get('assignment')\n    }\n\n    ionViewDidLoad() {\n    }\n\n    get person(): Person {\n        return this.assignment.person;\n    }\n\n    add_roles_to_alert(alert, input_type = 'checkbox', handler = (r) => {\n    }) {\n        let all_roles = this.rootStore.draft_service.roles;\n        for (let r of all_roles) {\n            if (input_type == 'button') {\n                alert.addButton({\n                    text: r.name,\n                    handler: handler(r)\n                })\n            } else {\n                alert.addInput({\n                    type: input_type,\n                    label: r.name,\n                    value: r.uuid\n                })\n            }\n        }\n    }\n\n    add_cancel_to_alert(alert, handler = () => {\n    }) {\n        alert.addButton({\n            text: 'Cancel',\n            role: 'cancel',\n            handler: handler\n        });\n    }\n\n    add_new_role() {\n        // Show a list of possible roles\n        let alert = this.alertCtrl.create({});\n        this.add_roles_to_alert(alert, 'checkbox');\n        this.add_cancel_to_alert(alert);\n\n        alert.addButton({\n            text: 'Add',\n            handler: data => {\n                // We receive an array of 'values'\n                for (let role_id of data) {\n                    let role_to_add = this.rootStore.draft_service.find_role_by_uuid(role_id);\n                    if (role_to_add) {\n                        this.assignment.add_role(role_to_add);\n                    }\n                }\n                console.log(`selected: ${JSON.stringify(data)}`)\n            }\n        });\n\n        alert.setTitle('Choose roles to add');\n        alert.present()\n    }\n\n    role_tapped(role: Role) {\n        this.navCtrl.push('RoleDetailPage', {\n            'assignment': this.assignment,\n            'role': role\n        });\n    }\n\n    add_new_rule() {\n        let alert = this.alertCtrl.create({});\n        this.active = this.navCtrl.getActive();\n\n        /*\n        Rule types\n         */\n        alert.addButton({\n            'text': 'If in role...',\n            handler: () => {\n                this.add_if_in_role_rule()\n            }\n        });\n        alert.addButton({\n            'text': \"I'd like to be on with...\",\n            handler: () => {\n                this.add_try_to_be_on_with_rule()\n            }\n        });\n\n        this.add_cancel_to_alert(alert);\n\n        alert.setTitle('Choose rule to add');\n        alert.present()\n    }\n\n    private add_if_in_role_rule() {\n        let list_of_things = this.rootStore.draft_service.roles;\n        this.navCtrl.push('list-of-things', {\n            things: list_of_things,\n            'title': 'When in role...',\n            'item-pressed': (item) => {\n                this.continue_add_in_role(item);\n            },\n            'show-push': true\n        });\n    }\n\n    private add_try_to_be_on_with_rule() {\n        let popover = this.popoverCtrl.create('TryToScheduleWithOtherPage', {\n            'callback': (person, distance, max) => {\n                let availability = new Availability(distance, AvailabilityUnit.EVERY_N_WEEKS);\n                let schedule = new TryToScheduleWith(person, availability, max);\n                this.assignment.add_secondary_action(schedule);\n            }\n        }, {\n            cssClass: 'try-popover'\n        });\n        popover.present();\n    }\n\n    private continue_add_in_role(if_in_this_role: Role) {\n        let roles = this.rootStore.draft_service.roles;\n        this.navCtrl.push('list-of-things', {\n            things: roles,\n            'title': 'Also be in role...',\n            'label-callback': (t) => {\n                t.toString()\n            },\n            'item-pressed': (item: Role) => {\n                // DO IT\n                if (this.active) {\n                    this.navCtrl.popTo(this.active);\n\n                    let new_role = new ScheduleOn(this.assignment.person, item);\n                    this.assignment.if_assigned_to(if_in_this_role).then(new_role)\n                }\n            },\n            'show-push': true\n        });\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/person-assignment/person-assignment.ts"],"sourceRoot":""}